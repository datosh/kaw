#include <stdio.h>
#include <stdint.h>

#include "aes.h"

uint8_t TestValues[16] = { 112, 160, 201, 73, 3, 157, 206, 218, 177, 197, 122, 66, 110, 70, 251, 86 };

uint8_t msg[] = { 0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF };
uint8_t key[] = { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F };

uint8_t msg256[] = { 0x6b, 0xc1, 0xbe, 0xe2, 0x2e, 0x40, 0x9f, 0x96, 0xe9, 0x3d, 0x7e, 0x11, 0x73, 0x93, 0x17, 0x2a };
uint8_t key256[] = { 0x60, 0x3d, 0xeb, 0x10, 0x15, 0xca, 0x71, 0xbe, 0x2b, 0x73, 0xae, 0xf0, 0x85, 0x7d, 0x77, 0x81, 0x1f, 0x35, 0x2c, 0x07, 0x3b, 0x61, 0x08, 0xd7, 0x2d, 0x98, 0x10, 0xa3, 0x09, 0x14, 0xdf, 0xf4 };

int compareBuf(uint8_t buf[16], uint8_t Testbuf[16])
{
	int i;
	for (i = 0; i < 16; i++)
	{
		if (buf[i] != Testbuf[i])
		{
			return 1;
		}
	}
	return 0;
}

int main(int argc, char** argv) {

	// Do 128 bit encryption
	aes_context ctx;
	aes_init(&ctx, key, 128);
	aes_encrypt(&ctx, msg, 16);
	printState(ctx.state);
	aes_free(&ctx);

	/*
	// Do 256 bit encryption
	aes_init(&ctx, key256, 256);
	aes_encrypt(&ctx, msg256, 16);
	printState(ctx.state);
	aes_free(&ctx);	*/

	return 0;
}